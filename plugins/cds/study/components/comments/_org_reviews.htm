{% set data = __SELF__.data.comments %}

{% if data is not empty %}

<div class="reviews">
    <!-- <div class="container"> -->
        <div class="row">
            <div class="col-12">
                <div class="reviews__title">Отзывы</div>
                <div class="reviews__body">
                    <div class="row">
                        {% for item in data %}
                        {% if loop.index < 4 %}
                        {% set author_name = item.user ? item.user.fullname : item.guest_name %}
                        {% set rateSum = item.rates.sum('value') %}
                        <div class="col-12 col-sm-6 col-md-4">
                            <div class="reviews__column reviews-item">
                                <div class="reviews-item__topblock">
                                    <div class="reviews-item__image"><img src="{{ item.user ? item.user.getAvatarThumb(50, 'crop') : item.getAnonymAvatar(50) }}" alt="{{ author_name }}"></div>
                                    <div>
                                        <a class="reviews-item__title">{{ author_name }}</a>
                                        <div class="reviews-item__date">
                                            <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M6.5 0C2.90927 0 0 2.90927 0 6.5C0 10.0907 2.90927 13 6.5 13C10.0907 13 13 10.0907 13 6.5C13 2.90927 10.0907 0 6.5 0ZM12.1613 6.5C12.1613 9.61109 9.64254 12.1613 6.5 12.1613C3.38891 12.1613 0.83871 9.64254 0.83871 6.5C0.83871 3.38891 3.35746 0.83871 6.5 0.83871C9.61109 0.83871 12.1613 3.35746 12.1613 6.5ZM8.25867 8.81431L6.13044 7.26794C6.04919 7.20766 6.00202 7.11331 6.00202 7.01371V2.83065C6.00202 2.65766 6.14355 2.51613 6.31653 2.51613H6.68347C6.85645 2.51613 6.99798 2.65766 6.99798 2.83065V6.66512L8.84577 8.00968C8.9873 8.11189 9.01613 8.30847 8.91391 8.45L8.69899 8.74617C8.59677 8.88508 8.4002 8.91653 8.25867 8.81431Z" fill="#828282"></path>
                                            </svg>
                                            <span>{{ item.createdDate }}</span>
                                        </div>
                                        <div class="reviews-item__like">
                                            <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M12.6104 7.25367C12.8625 6.92679 13 6.5 13 5.97868C13 5.02211 12.1856 4.13606 11.1534 4.13606H9.37226C9.59367 3.69507 9.89772 3.14808 9.89772 2.36336C9.89775 0.880344 9.30612 0 7.79264 0C7.03104 0 6.74842 0.962762 6.60362 1.70696C6.51711 2.15158 6.43538 2.57156 6.18404 2.8229C5.58558 3.42139 4.67188 4.875 4.12298 5.17017C4.0674 5.19358 3.99638 5.21201 3.91904 5.22661C3.77246 5.01424 3.52754 4.875 3.25 4.875H0.8125C0.363771 4.875 0 5.23877 0 5.6875V12.1875C0 12.6362 0.363771 13 0.8125 13H3.25C3.69873 13 4.0625 12.6362 4.0625 12.1875V11.9656C4.88757 11.9656 6.61901 13.0002 8.56819 12.9996C8.70797 12.9997 9.52415 13.0004 9.60954 12.9996C11.1147 13 11.952 12.0885 11.9032 10.7197C12.2873 10.2696 12.4755 9.61939 12.3659 9.01591C12.6822 8.52013 12.75 7.82077 12.6104 7.25367ZM0.8125 12.1875V5.6875H3.25V12.1875H0.8125ZM11.5786 7.01675C11.9844 7.3125 11.9844 8.53125 11.4362 8.81098C11.7795 9.38887 11.4705 10.1622 11.055 10.3851C11.2655 11.7191 10.5735 12.1778 9.6023 12.1872C9.51821 12.1879 8.65658 12.1872 8.56822 12.1872C6.71651 12.1872 5.14704 11.1531 4.06253 11.1531V5.98267C5.01996 5.98267 5.89839 4.25765 6.75858 3.39744C7.53413 2.62189 7.27561 1.32928 7.79266 0.812246C9.08527 0.812246 9.08527 1.71404 9.08527 2.36338C9.08527 3.43459 8.30972 3.9145 8.30972 4.94858H11.1534C11.7306 4.94858 12.185 5.46564 12.1875 5.98267C12.19 6.4997 11.9844 6.90625 11.5786 7.01675ZM2.64062 10.9688C2.64062 11.3053 2.3678 11.5781 2.03125 11.5781C1.6947 11.5781 1.42188 11.3053 1.42188 10.9688C1.42188 10.6322 1.6947 10.3594 2.03125 10.3594C2.3678 10.3594 2.64062 10.6322 2.64062 10.9688Z" fill="#828282"></path>
                                            </svg>
                                            <span>{{ rateSum }}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="reviews-item__text">{{ item.body }}</div>
                                <!-- class="starN" - число звезд N -->
                                {% if item.rate %}
                                <div class="reviews-item__star star{{ item.rate }}">
                                    <svg viewBox="0 -10 511.99143 511" xmlns="http://www.w3.org/2000/svg"><path d="m510.652344 185.882812c-3.371094-10.367187-12.566406-17.707031-23.402344-18.6875l-147.796875-13.417968-58.410156-136.75c-4.3125-10.046875-14.125-16.53125-25.046875-16.53125s-20.738282 6.484375-25.023438 16.53125l-58.410156 136.75-147.820312 13.417968c-10.835938 1-20.011719 8.339844-23.402344 18.6875-3.371094 10.367188-.257813 21.738282 7.9375 28.925782l111.722656 97.964844-32.941406 145.085937c-2.410156 10.667969 1.730468 21.699219 10.582031 28.097656 4.757813 3.457031 10.347656 5.183594 15.957031 5.183594 4.820313 0 9.644532-1.28125 13.953125-3.859375l127.445313-76.203125 127.421875 76.203125c9.347656 5.585938 21.101562 5.074219 29.933593-1.324219 8.851563-6.398437 12.992188-17.429687 10.582032-28.097656l-32.941406-145.085937 111.722656-97.964844c8.191406-7.1875 11.308594-18.535156 7.9375-28.925782zm-252.203125 223.722657"></path></svg>
                                    <svg viewBox="0 -10 511.99143 511" xmlns="http://www.w3.org/2000/svg"><path d="m510.652344 185.882812c-3.371094-10.367187-12.566406-17.707031-23.402344-18.6875l-147.796875-13.417968-58.410156-136.75c-4.3125-10.046875-14.125-16.53125-25.046875-16.53125s-20.738282 6.484375-25.023438 16.53125l-58.410156 136.75-147.820312 13.417968c-10.835938 1-20.011719 8.339844-23.402344 18.6875-3.371094 10.367188-.257813 21.738282 7.9375 28.925782l111.722656 97.964844-32.941406 145.085937c-2.410156 10.667969 1.730468 21.699219 10.582031 28.097656 4.757813 3.457031 10.347656 5.183594 15.957031 5.183594 4.820313 0 9.644532-1.28125 13.953125-3.859375l127.445313-76.203125 127.421875 76.203125c9.347656 5.585938 21.101562 5.074219 29.933593-1.324219 8.851563-6.398437 12.992188-17.429687 10.582032-28.097656l-32.941406-145.085937 111.722656-97.964844c8.191406-7.1875 11.308594-18.535156 7.9375-28.925782zm-252.203125 223.722657"></path></svg>
                                    <svg viewBox="0 -10 511.99143 511" xmlns="http://www.w3.org/2000/svg"><path d="m510.652344 185.882812c-3.371094-10.367187-12.566406-17.707031-23.402344-18.6875l-147.796875-13.417968-58.410156-136.75c-4.3125-10.046875-14.125-16.53125-25.046875-16.53125s-20.738282 6.484375-25.023438 16.53125l-58.410156 136.75-147.820312 13.417968c-10.835938 1-20.011719 8.339844-23.402344 18.6875-3.371094 10.367188-.257813 21.738282 7.9375 28.925782l111.722656 97.964844-32.941406 145.085937c-2.410156 10.667969 1.730468 21.699219 10.582031 28.097656 4.757813 3.457031 10.347656 5.183594 15.957031 5.183594 4.820313 0 9.644532-1.28125 13.953125-3.859375l127.445313-76.203125 127.421875 76.203125c9.347656 5.585938 21.101562 5.074219 29.933593-1.324219 8.851563-6.398437 12.992188-17.429687 10.582032-28.097656l-32.941406-145.085937 111.722656-97.964844c8.191406-7.1875 11.308594-18.535156 7.9375-28.925782zm-252.203125 223.722657"></path></svg>
                                    <svg viewBox="0 -10 511.99143 511" xmlns="http://www.w3.org/2000/svg"><path d="m510.652344 185.882812c-3.371094-10.367187-12.566406-17.707031-23.402344-18.6875l-147.796875-13.417968-58.410156-136.75c-4.3125-10.046875-14.125-16.53125-25.046875-16.53125s-20.738282 6.484375-25.023438 16.53125l-58.410156 136.75-147.820312 13.417968c-10.835938 1-20.011719 8.339844-23.402344 18.6875-3.371094 10.367188-.257813 21.738282 7.9375 28.925782l111.722656 97.964844-32.941406 145.085937c-2.410156 10.667969 1.730468 21.699219 10.582031 28.097656 4.757813 3.457031 10.347656 5.183594 15.957031 5.183594 4.820313 0 9.644532-1.28125 13.953125-3.859375l127.445313-76.203125 127.421875 76.203125c9.347656 5.585938 21.101562 5.074219 29.933593-1.324219 8.851563-6.398437 12.992188-17.429687 10.582032-28.097656l-32.941406-145.085937 111.722656-97.964844c8.191406-7.1875 11.308594-18.535156 7.9375-28.925782zm-252.203125 223.722657"></path></svg>
                                    <svg viewBox="0 -10 511.99143 511" xmlns="http://www.w3.org/2000/svg"><path d="m510.652344 185.882812c-3.371094-10.367187-12.566406-17.707031-23.402344-18.6875l-147.796875-13.417968-58.410156-136.75c-4.3125-10.046875-14.125-16.53125-25.046875-16.53125s-20.738282 6.484375-25.023438 16.53125l-58.410156 136.75-147.820312 13.417968c-10.835938 1-20.011719 8.339844-23.402344 18.6875-3.371094 10.367188-.257813 21.738282 7.9375 28.925782l111.722656 97.964844-32.941406 145.085937c-2.410156 10.667969 1.730468 21.699219 10.582031 28.097656 4.757813 3.457031 10.347656 5.183594 15.957031 5.183594 4.820313 0 9.644532-1.28125 13.953125-3.859375l127.445313-76.203125 127.421875 76.203125c9.347656 5.585938 21.101562 5.074219 29.933593-1.324219 8.851563-6.398437 12.992188-17.429687 10.582032-28.097656l-32.941406-145.085937 111.722656-97.964844c8.191406-7.1875 11.308594-18.535156 7.9375-28.925782zm-252.203125 223.722657"></path></svg>
                                    <span>({{ item.rate }})</span>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                    </div>

                </div>
                {% if data|length > 3 %}
                <a href="#nav-profile" class="button button--orange">Смотреть все</a>
                {% endif %}
            </div>
        </div>
    <!-- </div> -->
</div>

{% endif %}